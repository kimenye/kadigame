/*
 Name: shotgun.js
 License: MIT
 Version: 3.1
 URL: github.com/jgnewman/shotgun
 */
(function(a){'use strict';var b='3.1',c=999999,d={},e,f,g;function Events(){}function InternalEvents(){}e=new Events();f=new InternalEvents();function h(r,s){var i,l=r.length;for(i=0;i<l;i+=1){s(r[i],i);}}function j(r,s){var i;for(i in r){if(Object.prototype.hasOwnProperty.call(r,i)){s(r[i],i);}}}function k(r){return r.slice(0,r.length-1);}function m(r){return r[r.length-1];}function n(){var r="SG-",i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz";r+=(new Date()).getTime();c+=1;r+=("-"+c+"-");if(c===9999999){c=1000000;}for(i=0;i<25;i+=1){r+=s[Math.floor(Math.random()*s.length)];}return r;}function o(r){return(r.slice(0,9)==='_internal');}function p(r,s,t){var u;if(s===f&&t){throw new Error('Attempt to subscribe to an internal event without first registering the event.');}u=n();d[u]={};function Directory(){}Directory.prototype={"_SG_dirEvents":d[u],"_SG_dirEventsKey":u,"_SG_parentDir":s,"_SG_dirName":r};return new Directory();}function q(r,s,t,u){var v=r._SG_dirEvents;if(s){v[s].apply(null,t);return true;}j(v,function(w){w.apply(null,t);});if(!u){return true;}return j(r,function(w){return q(w,s,t,u);});}g={"fire":function(r,s,t){var u,v,w,x,y;if(typeof s==='string'){v=[];w=s;}else{v=s;w=t;}if(o(r)){r=r.slice(10);y=f;}else{y=e;}if(m(r)==='*'){x=true;u=k(k(r)).split('/');}else{u=r.split('/');}h(u,function(z){y=y[z];});if(!y){return false;}return q(y,w,v,x);},"listen":function(r,s,t){var u=t||n(),v,w;if(o(r)){r=r.slice(10);w=f;}else{w=e;}v=r.split('/');h(v,function(x){w[x]=w[x]||p(x,w,true);w=w[x];});w._SG_dirEvents[u]=s;this.fire('_internal/newListener',[r,s,u]);return u;},"registerInternal":function(){h(arguments,function(r){var s=f,t=r.split('/');h(t,function(u){s[u]=s[u]||p(u,s,false);s=s[u];});});return true;},"remove":function(r,s){var t,u;if(o(r)){r=r.slice(10);u=f;}else{u=e;}t=r.split('/');h(t,function(v){u=u[v];});if(s){delete u._SG_dirEvents[s];this.fire('_internal/rmListener',[r,s]);return true;}delete d[u._SG_dirEventsKey];delete u._SG_parentDir[u._SG_dirName];this.fire('_internal/rmEvent',[r]);return true;},"attempt":function(r,s,t){var u,v,w;if(typeof r==='function'){v=r;w=s;}else{u=r;v=s;w=t;}try{v();}catch(x){if(u){this.fire(u,[x,v],w);}this.fire('_internal/tryError',[x,v],w);}},"getEvents":function(){return e;},"getInternalEvents":function(){return f;},"version":b};g.registerInternal('newListener','rmEvent','rmListener','tryError');if(a.define&&typeof a.define==='function'&&a.define.amd){a.define('SHOTGUN',[],g);a.define('SG',[],g);}else if(a.module&&a.module.exports){a.module.exports=g;}else{a.SHOTGUN=a.SG=g;}}(this));